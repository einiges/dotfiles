$mod = SUPER

# F13: XF86Tools
# F14: XF86Launch5
# F15: XF86Launch6
# F16: XF86Launch7
# F17: XF86Launch8
# F18: XF86Launch9
# F19: NoSymbol
# F20: XF86AudioMicMute
# F21: XF86TouchPadToggle
# F22: XF86TouchPadOn
# F23: XF86TouchPadOff
# F24: NoSymbol

$dispatch = hyprctl dispatch
$exitsubmap = $dispatch submap reset
$execx = exec, $exitsubmap &&
$dispatchx = $execx $dispatch

$terminal = kitty --single-instance

# hyprland

bind = $mod, F1, exec, $hypr/bin/gamemode
bind = $mod, F5, exec, hyprctl reload



#   QUICK LAUNCH

bind = $mod, Return, exec, $terminal

bind = $mod, e, submap, quicklaunch
submap = quicklaunch
	bindi = , f, $execx thunar
	bindi = , w, $execx browser
	bindi = , v, $execx pavucontrol
	bind = , catchall, submap, reset
submap = reset

bind = , XF86Explorer, exec, thunar



#   LAUNCHERS

bindr = $mod, $mod_L , exec, pkill rofi || rofi -show-icons -show drun -drun-exclude-categories 'UserSession,SystemPower'

bindr = $mod SHIFT, Shift_L, submap, menuexec
submap = menuexec
	# man (1,5)
	bindr = , m, $execx man --apropos . --sections='1,5' | cut --delimiter=' ' --fields=1 | rofi -dmenu | xargs --no-run-if-empty $terminal man
	bindr = , n, $execx man --apropos .                  | cut --delimiter=' ' --fields=1 | rofi -dmenu | xargs --no-run-if-empty $terminal man

	# passmenu
	bindr = , p, $execx passmenu-rofi
	
	bind = , catchall, submap, reset
submap = reset



#   SCREENSHOT

bind = $mod, p,     submap, screenshot
bind =     , Print, submap, screenshot
submap = screenshot

	$scrn    = grim -g -
	$scrncpy = $scrn - | wl-copy

	# active window
	$active_window_geometry = hyprctl activewindow -j | jq -r '"\(.at[0]),\(.at[1]) \(.size[0])x\(.size[1])"'
	bind =      , w, $execx $active_window_geometry | $scrn
	bind = SHIFT, W, $execx $active_window_geometry | $scrncpy

	# active workspace
	#     like monitor, excluding reserved area
	$active_workspace_geometry = hyprctl monitors -j | jq -r --arg monitor "$(hyprctl activeworkspace -j | jq -r '.monitor')" 'map(select(.name == $monitor) | "\(.x + .reserved[0]),\(.y + .reserved[1]) \(.width - .reserved[0] - .reserved[2])x\(.height - .reserved[1] - .reserved[3])") | first'
	bind =       , r, $execx $active_workspace_geometry | $scrn
	bind = SHIFT , R, $execx $active_workspace_geometry | $scrncpy

	# active monitor
	$active_monitor_geometry = hyprctl monitors -j | jq -r --arg monitor "$(hyprctl activeworkspace -j | jq -r '.monitor')" 'map(select(.name == $monitor) | "\(.x),\(.y) \(.width)x\(.height)") | first'
	bind =      , m, $execx $active_monitor_geometry | $scrn
	bind = SHIFT, M, $execx $active_monitor_geometry | $scrncpy

	# area: free selection
	$area_selection_geometry = slurp -d
	bind =      , a, $execx $area_selection_geometry | $scrn
	bind = SHIFT, A, $execx $area_selection_geometry | $scrncpy

	# everything
	bind =      , e, $execx grim
	bind = SHIFT, E, $execx grim | wl-copy

	bindr = , catchall, submap, reset
submap = reset



#   WINDOW OPERATIONS

bind = $mod      , x, closewindow, activewindow
bind = $mod SHIFT, X, killwindow,  activewindow

bind = $mod,       f, fullscreen, 1
bind = $mod SHIFT, F, fullscreen, 0
bind = $mod CTRL,  f, togglefloating, active

bind = $mod, s, pin, active

# focus window
bind = $mod, n, movefocus, l
bind = $mod, r, movefocus, d
bind = $mod, t, movefocus, u
bind = $mod, d, movefocus, r

bind = $mod, space, focusurgentorlast
bind = $mod, tab, cyclenext, prev hist
bind = $mod SHIFT, tab, cyclenext, next hist

# position windows
bind = $mod SHIFT, n, swapwindow, l
bind = $mod SHIFT, r, swapwindow, d
bind = $mod SHIFT, t, swapwindow, u
bind = $mod SHIFT, d, swapwindow, r

bind = $mod SHIFT, space, centerwindow

# resize window
binde = $mod CTRL, n, resizeactive,  -20%   0%
binde = $mod CTRL, r, resizeactive,    0%  20%
binde = $mod CTRL, t, resizeactive,    0% -20%
binde = $mod CTRL, d, resizeactive,   20%   0%

# layout
bind = $mod MOD5, n, layoutmsg, preselect l
bind = $mod MOD5, r, layoutmsg, preselect d
bind = $mod MOD5, t, layoutmsg, preselect u
bind = $mod MOD5, d, layoutmsg, preselect r
bind = $mod MOD5, space, layoutmsg, togglesplit
bind = $mod MOD5, f, layoutmsg, movetoroot

# group
bind = $mod ALT, return, togglegroup
bind = $mod ALT, n, movewindoworgroup, l
bind = $mod ALT, r, movewindoworgroup, d
bind = $mod ALT, t, movewindoworgroup, u
bind = $mod ALT, d, movewindoworgroup, r

bind = $mod ALT,       tab,  changegroupactive, f
bind = $mod ALT SHIFT, tab,  changegroupactive, b
bind = $mod SHIFT, comma,  movegroupwindow,   b
bind = $mod SHIFT, period, movegroupwindow,   f

# focus workspace
bind = $mod, minus, togglespecialworkspace
bind = $mod, 1, focusworkspaceoncurrentmonitor, 1
bind = $mod, 2, focusworkspaceoncurrentmonitor, 2
bind = $mod, 3, focusworkspaceoncurrentmonitor, 3
bind = $mod, 4, focusworkspaceoncurrentmonitor, 4
bind = $mod, 5, focusworkspaceoncurrentmonitor, 5
bind = $mod, 6, focusworkspaceoncurrentmonitor, 6
bind = $mod, 7, focusworkspaceoncurrentmonitor, 7
bind = $mod, 8, focusworkspaceoncurrentmonitor, 8
bind = $mod, 9, focusworkspaceoncurrentmonitor, 9
bind = $mod, 0, focusworkspaceoncurrentmonitor, 10

bind = $mod, dead_circumflex, focusworkspaceoncurrentmonitor, previous

# move to workspace
bind = $mod SHIFT, 1, movetoworkspacesilent, 1
bind = $mod SHIFT, 2, movetoworkspacesilent, 2
bind = $mod SHIFT, 3, movetoworkspacesilent, 3
bind = $mod SHIFT, 4, movetoworkspacesilent, 4
bind = $mod SHIFT, 5, movetoworkspacesilent, 5
bind = $mod SHIFT, 6, movetoworkspacesilent, 6
bind = $mod SHIFT, 7, movetoworkspacesilent, 7
bind = $mod SHIFT, 8, movetoworkspacesilent, 8
bind = $mod SHIFT, 9, movetoworkspacesilent, 9
bind = $mod SHIFT, 0, movetoworkspacesilent, 10

bind = $mod,       h, focusmonitor, -1
bind = $mod,       g, focusmonitor, +1
bind = $mod SHIFT, H, movewindow, mon:-1 silent
bind = $mod SHIFT, G, movewindow, mon:+1 silent
bind = $mod CTRL,  h, swapactiveworkspaces, current -1
bind = $mod CTRL,  g, swapactiveworkspaces, current +1

#
bindr = $mod, b, exec, systemctl --user kill --signal=SIGUSR1 waybar



#   MEDIA CONTROL

# audio:out
binde =      , XF86AudioMute       , exec, wpctl set-mute   @DEFAULT_SINK@ toggle
binde =      , XF86AudioLowerVolume, exec, wpctl set-volume @DEFAULT_SINK@ 5%-
binde =      , XF86AudioRaiseVolume, exec, wpctl set-volume @DEFAULT_SINK@ 5%+

# audio:in
binde =      , XF86AudioMicMute    , exec, wpctl set-mute   @DEFAULT_SOURCE@ toggle
binde = ALT  , XF86AudioMute       , exec, wpctl set-mute   @DEFAULT_SOURCE@ toggle
binde = ALT  , XF86AudioLowerVolume, exec, wpctl set-volume @DEFAULT_SOURCE@ 5%-
binde = ALT  , XF86AudioRaiseVolume, exec, wpctl set-volume @DEFAULT_SOURCE@ 5%+

# player control
binde = CTRL, XF86AudioRaiseVolume, exec, playerctl volume 0.05+
binde = CTRL, XF86AudioLowerVolume, exec, playerctl volume 0.05-

bindl =     , XF86AudioPlay, exec, playerctl play-pause
bindl =     , XF86AudioStop, exec, playerctl stop
bindl =     , XF86AudioPrev, exec, playerctl previous
bindl =     , XF86AudioNext, exec, playerctl next

bindl = ALT  , XF86AudioPlay, exec, playerctl --all-players play
bindl = ALT  , XF86AudioStop, exec, playerctl --all-players pause
bindl = ALT  , XF86AudioPrev, exec, playerctld shift
bindl = ALT  , XF86AudioNext, exec, playerctld unshift

# monitor brightness control
bindel = SHIFT, XF86MonBrightnessDown, exec, brightnessctl --quiet set    0%
bindel =      , XF86MonBrightnessDown, exec, brightnessctl --quiet set   10%-
bindel =      , XF86MonBrightnessUp,   exec, brightnessctl --quiet set  +10%
bindel = SHIFT, XF86MonBrightnessUp,   exec, brightnessctl --quiet set  100%



# SYSTEM

$logout      = loginctl terminate-user ''
$lockSession = loginctl lock-session

bind = $mod,       l, exec, $lockSession
bind = $mod SHIFT, L, exec, rofi -show-icons -show drun -drun-categories 'UserSession,SystemPower'



# MOUSE BINDINGS

bindm = $mod, mouse:272, movewindow
bindm = $mod, mouse:273, resizewindow
bindm = $mod, mouse:276, resizewindow 1
bind = $mod, mouse:275, togglefloating, active
bind = $mod, mouse:274, closewindow, activewindow

bind = $mod, mouse_down, workspace, e+1
bind = $mod, mouse_up,   workspace, e-1

